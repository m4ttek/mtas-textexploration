<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Status.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MTAS</a> &gt; <a href="index.source.html" class="el_package">mtas.codec.util</a> &gt; <span class="el_source">Status.java</span></div><h1>Status.java</h1><pre class="source lang-java linenums">package mtas.codec.util;

import java.io.IOException;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;

/**
 * The Class Status.
 */
<span class="fc" id="L11">public class Status {</span>

  /** The Constant TYPE_SEGMENT. */
  public static final String TYPE_SEGMENT = &quot;segment&quot;;

  /** The Constant KEY_NUMBER. */
  public static final String KEY_NUMBER = &quot;number&quot;;
  
  /** The Constant KEY_NUMBEROFDOCUMENTS. */
  public static final String KEY_NUMBEROFDOCUMENTS = &quot;numberOfDocuments&quot;;

  /** The number segments finished. */
<span class="fc" id="L23">  public volatile Integer numberSegmentsFinished = null;</span>
  
  /** The number segments total. */
<span class="fc" id="L26">  public volatile Integer numberSegmentsTotal = null;</span>

  /** The sub number segments total. */
<span class="fc" id="L29">  public volatile Integer subNumberSegmentsTotal = null;</span>
  
  /** The sub number segments finished total. */
<span class="fc" id="L32">  public volatile Integer subNumberSegmentsFinishedTotal = null;</span>
  
  /** The sub number segments finished. */
<span class="fc" id="L35">  public volatile Map&lt;String, Integer&gt; subNumberSegmentsFinished = new ConcurrentHashMap&lt;&gt;();</span>

  /** The number documents found. */
<span class="fc" id="L38">  public volatile Long numberDocumentsFound = null;</span>
  
  /** The number documents finished. */
<span class="fc" id="L41">  public volatile Long numberDocumentsFinished = null;</span>
  
  /** The number documents total. */
<span class="fc" id="L44">  public volatile Long numberDocumentsTotal = null;</span>

  /** The sub number documents total. */
<span class="fc" id="L47">  public volatile Long subNumberDocumentsTotal = null;</span>
  
  /** The sub number documents finished total. */
<span class="fc" id="L50">  public volatile Long subNumberDocumentsFinishedTotal = null;</span>
  
  /** The sub number documents finished. */
<span class="fc" id="L53">  public volatile Map&lt;String, Long&gt; subNumberDocumentsFinished = new ConcurrentHashMap&lt;&gt;();</span>

  /**
   * Inits the.
   *
   * @param numberOfDocuments the number of documents
   * @param numberOfSegments the number of segments
   * @throws IOException Signals that an I/O exception has occurred.
   */
  public void init(long numberOfDocuments, int numberOfSegments) throws IOException {
<span class="pc bpc" id="L63" title="1 of 2 branches missed.">    if (numberDocumentsTotal == null) {</span>
<span class="fc" id="L64">      numberDocumentsTotal = numberOfDocuments;</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">    } else if (numberDocumentsTotal != numberOfDocuments) {</span>
<span class="nc" id="L66">      throw new IOException(&quot;conflict number of documents: &quot; + numberDocumentsTotal + &quot; / &quot; + numberOfDocuments);</span>
    }
<span class="pc bpc" id="L68" title="1 of 2 branches missed.">    if (numberSegmentsTotal == null) {</span>
<span class="fc" id="L69">      numberSegmentsTotal = numberOfSegments;</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">    } else if (numberSegmentsTotal != numberOfSegments) {</span>
<span class="nc" id="L71">      throw new IOException(&quot;conflict number of segments: &quot; + numberSegmentsTotal + &quot; / &quot; + numberOfSegments);</span>
    }
<span class="pc bpc" id="L73" title="1 of 2 branches missed.">    numberDocumentsFinished = (numberDocumentsFinished == null) ? Long.valueOf(0) : numberDocumentsFinished;</span>
<span class="pc bpc" id="L74" title="1 of 2 branches missed.">    if (numberSegmentsFinished == null) {</span>
<span class="fc" id="L75">      numberSegmentsFinished = 0;</span>
    }
<span class="fc" id="L77">    subNumberDocumentsTotal = numberDocumentsTotal * subNumberDocumentsFinished.size();</span>
<span class="pc bpc" id="L78" title="1 of 2 branches missed.">    subNumberDocumentsFinishedTotal = (subNumberDocumentsFinishedTotal == null) ? Long.valueOf(0)</span>
        : subNumberDocumentsFinishedTotal;
<span class="fc" id="L80">    subNumberSegmentsTotal = numberOfSegments * subNumberSegmentsFinished.size();</span>
<span class="pc bpc" id="L81" title="1 of 2 branches missed.">    if (subNumberSegmentsFinishedTotal == null) {</span>
<span class="fc" id="L82">      subNumberSegmentsFinishedTotal = 0;</span>
    }
<span class="fc" id="L84">  }</span>

  /**
   * Adds the subs.
   *
   * @param subItems the sub items
   */
  public void addSubs(Set&lt;String&gt; subItems) {
<span class="fc bfc" id="L92" title="All 2 branches covered.">    for (String subItem : subItems) {</span>
<span class="fc" id="L93">      addSub(subItem);</span>
<span class="fc" id="L94">    }</span>
<span class="fc" id="L95">  }</span>

  /**
   * Adds the sub.
   *
   * @param subItem the sub item
   */
  public void addSub(String subItem) {
<span class="pc bpc" id="L103" title="1 of 2 branches missed.">    if (!subNumberSegmentsFinished.containsKey(subItem)) {</span>
<span class="fc" id="L104">      subNumberSegmentsFinished.put(subItem, 0);</span>
<span class="pc bpc" id="L105" title="1 of 2 branches missed.">      if (numberSegmentsTotal != null) {</span>
<span class="nc" id="L106">        subNumberSegmentsTotal += numberSegmentsTotal;</span>
      }
    }
<span class="pc bpc" id="L109" title="1 of 2 branches missed.">    if (!subNumberDocumentsFinished.containsKey(subItem)) {</span>
<span class="fc" id="L110">      subNumberDocumentsFinished.put(subItem, Long.valueOf(0));</span>
<span class="pc bpc" id="L111" title="1 of 2 branches missed.">      if (numberDocumentsTotal != null) {</span>
<span class="nc" id="L112">        subNumberDocumentsTotal += numberDocumentsTotal;</span>
      }
    }
<span class="fc" id="L115">  }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>